{"chunk":4,"numChunks":6,"fileHash":"gwIGpW0Uz8yvXUuu674CmvkNU82PcIitokSH4fm+Olo=","filePath":"internal/handler/create_post_handler.go","content":"package handler\nfunc CreatePostHandler(w http.ResponseWriter, r *http.Request) {\n\tif r.Method == \"POST\" {\n\t\tuserID, err := session.GetUserIDFromSession(r)\n\t\tif util.ErrorCheckHandlers(w, r, \"Invalid session\", err, http.StatusUnauthorized) {\n\t\t\treturn\n\t\t}\n\n\t\ttitle := r.FormValue(\"title\")\n\t\tcontent := r.FormValue(\"content\")\n\t\tcategories := strings.Join(r.Form[\"categories\"], \", \")\n\n\t\tif title == \"\" || content == \"\" {\n\t\t\tif util.ErrorCheckHandlers(w, r, \"Post cannot be empty\", fmt.Errorf(\"post cannot be empty\"), http.StatusInternalServerError) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\treturn\n\t\t}\n\n\t\tcategoriesList := []string{\n\t\t\t\"General\",\n\t\t\t\"Local News & Events\",\n\t\t\t\"Viking line\",\n\t\t\t\"Travel\",\n\t\t\t\"Sailing\",\n\t\t\t\"Cuisine & food\",\n\t\t\t\"Politics\"}\n\n\t\tfor _, userCategory := range r.Form[\"categories\"] {\n\t\t\tcatValid := false\n\t\t\tfor _, categoryItem := range categoriesList {\n\t\t\t\tif categoryItem == userCategory {\n\t\t\t\t\tcatValid = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\tif !catValid {\n\t\t\t\tif util.ErrorCheckHandlers(w, r, \"Invalid category\", fmt.Errorf(\"invalid category\"), http.StatusInternalServerError) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tif len(categories) == 0 {\n\t\t\tcategories = \"General\"\n\t\t}\n\n\t\t// Insert the post into the database\n\t\tif err := post.CreatePost(userID, title, content, categories); util.ErrorCheckHandlers(w, r, \"Post creation failed\", err, http.StatusInternalServerError) {\n\t\t\treturn\n\t\t}\n\n\t\tid, err := post.GetPostId()\n\t\tif util.ErrorCheckHandlers(w, r, \"Database issue\", err, http.StatusInternalServerError) {\n\t\t\treturn\n\t\t}\n\n\t\thttp"}